/*! For license information please see widget.bundle.js.LICENSE.txt */
(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return r};var n,r={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(n){d=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof x?e:x,i=Object.create(o.prototype),s=new H(r||[]);return a(i,"_invoke",{value:T(t,n,s)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=u;var f="suspendedStart",y="suspendedYield",g="executing",m="completed",v={};function x(){}function b(){}function w(){}var L={};d(L,l,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(M([])));E&&E!==o&&i.call(E,l)&&(L=E);var C=w.prototype=x.prototype=Object.create(L);function j(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function S(e,n){function r(o,a,s,l){var c=h(e[o],e,a);if("throw"!==c.type){var p=c.arg,d=p.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(t){r("next",t,s,l)}),(function(t){r("throw",t,s,l)})):n.resolve(d).then((function(t){p.value=t,s(p)}),(function(t){return r("throw",t,s,l)}))}l(c.arg)}var o;a(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,o){r(t,e,n,o)}))}return o=o?o.then(i,i):i()}})}function T(t,e,r){var o=f;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:n,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var c=h(t,e,r);if("normal"===c.type){if(o=r.done?m:y,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=m,r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=h(o,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function H(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function M(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return b.prototype=w,a(C,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=d(w,p,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,d(t,p,"GeneratorFunction")),t.prototype=Object.create(C),t},r.awrap=function(t){return{__await:t}},j(S.prototype),d(S.prototype,c,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new S(u(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(C),d(C,p,"Generator"),d(C,l,(function(){return this})),d(C,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=M,H.prototype={constructor:H,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return s.type="throw",s.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:M(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}},r}function n(t,e,n,r,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function s(t){n(a,o,i,s,l,"next",t)}function l(t){n(a,o,i,s,l,"throw",t)}s(void 0)}))}}var o,i="http://localhost:3000/api";function a(){return a=r(e().mark((function t(n){var a,s,l,c,p,d,u,h,f,y,g,m,v,x,b,w,L,k,E,C,j,S;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=document.createElement("div")).id="chat-widget",a.style.position="fixed",a.style.bottom="20px",a.style.right="20px",a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="flex-end",a.style.zIndex="1000",(s=document.createElement("div")).id="chat-container",s.style.width="400px",s.style.maxHeight="80vh",s.style.height="600px",s.style.border="1px solid #ccc",s.style.borderRadius="10px",s.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.1)",s.style.backgroundColor="#fff",s.style.display="none",s.style.flexDirection="column",s.style.overflow="hidden",s.style.marginBottom="10px",s.innerHTML='\n    <div id="chat-header" style="background-color: transparent; color: #333; padding: 10px; text-align: center; font-weight: bold; position: relative; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">\n      <div style="display: flex; align-items: center;">\n        <img src="" alt="" style="width: 30px; height: 30px; margin-right: 10px;">\n        <span></span>\n      </div>\n      <button id="close-chat" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #333; font-size: 20px; cursor: pointer; display: none;">✕</button>\n    </div>\n    <div id="chat-messages" style="flex: 1; padding: 10px; overflow-y: auto;"></div>\n    <div style="padding: 10px;">\n      <div style="display: flex; align-items: center; background-color: #f0f0f0; border-radius: 9999px; padding: 5px;">\n        <input id="chat-input" type="text" placeholder="Type a message..." style="flex: 1; padding: 10px; border: none; background: transparent; outline: none;">\n        <button id="chat-send" style="width: 40px; height: 40px; border-radius: 50%; background-color: white; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;">\n          <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 14 14" style="width: 20px; height: 20px; margin-left: -2px; margin-top: 1px;">\n            <path fill="#D1D5DB" fill-rule="evenodd" d="M13.854.146a.5.5 0 0 1 .113.534l-5 13a.5.5 0 0 1-.922.027l-2.091-4.6L9.03 6.03a.75.75 0 0 0-1.06-1.06L4.893 8.046l-4.6-2.09a.5.5 0 0 1 .028-.923l13-5a.5.5 0 0 1 .533.113" clip-rule="evenodd"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n  ',(l=document.createElement("button")).id="toggle-button",l.style.width="60px",l.style.height="60px",l.style.borderRadius="50%",l.style.backgroundColor="#007bff",l.style.color="white",l.style.border="none",l.style.cursor="pointer",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="center",c='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20.605 4.17a4.67 4.67 0 0 0-3.33-1.38H6.705a4.71 4.71 0 0 0-4.71 4.72v6.6a4.71 4.71 0 0 0 4.71 4.72h2.33l1.95 1.94c.127.143.284.255.46.33c.175.072.361.11.55.11q.286-.004.55-.11a1.6 1.6 0 0 0 .44-.31l2-2h2.33a4.7 4.7 0 0 0 3.33-1.38a4.8 4.8 0 0 0 1-1.53c.234-.575.357-1.19.36-1.81v-6.6a4.67 4.67 0 0 0-1.4-3.3m-13.24 8.17a1.66 1.66 0 1 1 1.66-1.66a1.67 1.67 0 0 1-1.66 1.66m4.63 0a1.66 1.66 0 1 1 0-3.32a1.66 1.66 0 0 1 0 3.32m4.62 0a1.66 1.66 0 1 1 1.66-1.66a1.67 1.67 0 0 1-1.66 1.66"/></svg>',p='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41z"/></svg>',l.innerHTML=c,(d=document.createElement("link")).href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap",d.rel="stylesheet",document.head.appendChild(d),(u=document.createElement("style")).textContent="\n    #chat-container, #chat-input {\n      font-family: 'Poppins', sans-serif;\n    }\n    #chat-container {\n      max-height: 80vh;\n      height: 600px;\n    }\n    @media (max-width: 768px) {\n      #chat-widget {\n        bottom: 0 !important;\n        right: 0 !important;\n        width: 100% !important;\n      }\n      #chat-container {\n        width: 100% !important;\n        height: 100vh !important;\n        max-height: none !important;\n        position: fixed !important;\n        top: 0 !important;\n        left: 0 !important;\n        right: 0 !important;\n        bottom: 0 !important;\n        margin: 0 !important;\n        border-radius: 0 !important;\n        border: none !important;\n        z-index: 9999 !important;\n      }\n      #chat-messages {\n        height: calc(100vh - 120px) !important;\n      }\n      #close-chat {\n        display: block !important;\n      }\n      #toggle-button {\n        position: fixed !important;\n        bottom: 20px !important;\n        right: 20px !important;\n      }\n    }\n  ",document.head.appendChild(u),t.prev=45,t.next=48,fetch("".concat(i,"/business/").concat(n));case 48:return h=t.sent,t.next=51,h.json();case 51:f=t.sent,y=f.name,g=f.logo_url,m=f.color,s.querySelector("#chat-header").innerHTML='\n      <div style="display: flex; align-items: center;">\n        <img src="'.concat(g,'" alt="').concat(y,' logo" style="width: 30px; height: 30px; margin-right: 10px;">\n        <span>').concat(y,'</span>\n      </div>\n      <button id="close-chat" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #333; font-size: 20px; cursor: pointer; display: none;">✕</button>\n    '),(v=document.createElement("style")).textContent="\n      #chat-header {\n        background-color: transparent !important;\n        color: #333 !important;\n        border-bottom: 1px solid #e0e0e0;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      #toggle-button {\n        background-color: ".concat(m," !important;\n      }\n      #chat-send {\n        background-color: white !important;\n        transition: background-color 0.3s ease;\n      }\n      #chat-send svg path {\n        fill: #D1D5DB !important; /* Light gray */\n        transition: fill 0.3s ease;\n      }\n      #chat-send.active svg path {\n        fill: #4B5563 !important; /* Dark gray */\n      }\n      .user-message {\n        background-color: ").concat(m," !important;\n        color: white !important;\n      }\n    "),document.head.appendChild(v),l.style.backgroundColor=m,a.appendChild(s),a.appendChild(l),document.body.appendChild(a),x=s.querySelector("#close-chat"),b=function(){var t=r(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="none"!==s.style.display,s.style.display=n?"none":"flex",l.innerHTML=n?c:p,window.innerWidth<=768&&(l.style.display=n?"block":"none",document.body.style.overflow=n?"auto":"hidden"),n||o){t.next=7;break}return t.next=7,S();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),l.onclick=b,x.onclick=b,w=s.querySelector("#chat-input"),L=s.querySelector("#chat-send"),k=s.querySelector("#chat-messages"),E=function(){w.value.trim()&&!C?(L.classList.add("active"),L.disabled=!1):(L.classList.remove("active"),L.disabled=C)},w.addEventListener("input",E),E(),C=!1,j=function(){var t=r(e().mark((function t(){var r,a,s,l,c,p,d;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!w.value.trim()||C||!o){t.next=59;break}return C=!0,L.disabled=!0,r=w.value,(a=document.createElement("div")).innerHTML='<div class="user-message">'.concat(r,"</div>"),a.style.display="flex",a.style.justifyContent="flex-end",a.style.margin="10px 0",a.firstChild.style.maxWidth="70%",a.firstChild.style.padding="8px 12px",a.firstChild.style.borderRadius="18px 18px 0 18px",k.appendChild(a),w.value="",E(),k.scrollTop=k.scrollHeight,t.next=18,new Promise((function(t){return setTimeout(t,400)}));case 18:return(s=document.createElement("div")).innerHTML='\n          <div class="typing-indicator" style="\n            display: inline-flex;\n            align-items: center;\n            background-color: #f1f0f0;\n            border-radius: 18px 18px 18px 0;\n            padding: 8px 12px;\n            margin: 10px 0;\n            min-height: 40px;\n            box-sizing: border-box;\n          ">\n            <span style="width: 6px; height: 6px; background-color: #999; border-radius: 50%; margin-right: 4px; animation: typing 1s infinite;"></span>\n            <span style="width: 6px; height: 6px; background-color: #999; border-radius: 50%; margin-right: 4px; animation: typing 1s infinite 0.3s;"></span>\n            <span style="width: 6px; height: 6px; background-color: #999; border-radius: 50%; animation: typing 1s infinite 0.6s;"></span>\n          </div>\n        ',s.style.display="flex",s.style.justifyContent="flex-start",k.appendChild(s),k.scrollTop=k.scrollHeight,(l=document.createElement("style")).textContent="\n          @keyframes typing {\n            0% { opacity: 0.3; }\n            50% { opacity: 1; }\n            100% { opacity: 0.3; }\n          }\n        ",document.head.appendChild(l),t.prev=27,t.next=30,fetch("".concat(i,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessId:n,messages:[{role:"user",content:r}],chatSessionId:o})});case 30:return c=t.sent,t.next=33,c.json();case 33:return p=t.sent,k.removeChild(s),(d=document.createElement("div")).innerHTML="<div>".concat(p.reply,"</div>"),d.style.display="flex",d.style.justifyContent="flex-start",d.style.margin="10px 0",d.firstChild.style.maxWidth="70%",d.firstChild.style.padding="8px 12px",d.firstChild.style.backgroundColor="#f1f0f0",d.firstChild.style.borderRadius="18px 18px 18px 0",k.appendChild(d),k.scrollTop=k.scrollHeight,t.next=48,fetch("".concat(i,"/save-messages"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatSessionId:o,userMessage:r,aiMessage:p.reply})});case 48:t.next=54;break;case 50:t.prev=50,t.t0=t.catch(27),console.error("Error:",t.t0),k.removeChild(s);case 54:return t.prev=54,C=!1,L.disabled=!1,E(),t.finish(54);case 59:case"end":return t.stop()}}),t,null,[[27,50,54,59]])})));return function(){return t.apply(this,arguments)}}(),L.onclick=function(){C||j()},w.addEventListener("keydown",(function(t){"Enter"===t.key&&(t.preventDefault(),C||j())})),window.addEventListener("resize",(function(){window.innerWidth>768?(s.style.removeProperty("position"),s.style.removeProperty("top"),s.style.removeProperty("left"),s.style.removeProperty("right"),s.style.removeProperty("bottom"),s.style.width="400px",s.style.height="600px",s.style.maxHeight="80vh",s.style.margin="0 0 10px 0",s.style.borderRadius="10px",l.style.display="flex",document.body.style.overflow="auto",l.innerHTML="none"!==s.style.display?p:c):"none"!==s.style.display?(l.style.display="none",document.body.style.overflow="hidden"):(l.style.display="flex",l.innerHTML=c)})),S=function(){var t=r(e().mark((function t(){var r,a;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(i,"/create-chat-session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessId:n})});case 3:return r=t.sent,t.next=6,r.json();case 6:a=t.sent,o=a.chatSessionId,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Error creating chat session:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),t.next=83;break;case 80:t.prev=80,t.t0=t.catch(45),console.error("Error fetching business details:",t.t0);case 83:case"end":return t.stop()}}),t,null,[[45,80]])}))),a.apply(this,arguments)}window.initChatWidget=function(t){return a.apply(this,arguments)}})();